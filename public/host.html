<!DOCTYPE html>
<html lang="pt-br">
<head>
  <!-- ============== METADADOS BÁSICOS ============== -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>ASAI – Host</title>
  <meta name="description" content="Tela do anfitrião: criar sala, iniciar jogo e conduzir as rodadas." />

  <!-- ============== ESTILOS ============== -->
  <link rel="stylesheet" href="/css/styles.css" />

  <!-- ============== BIBLIOTECAS (ANTES DOS SEUS SCRIPTS) ============== -->
  <!-- Socket.IO do servidor -->
  <script src="/socket.io/socket.io.js"></script>
  <!-- QRCode (para gerar QR de entrada dos jogadores) -->
  <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js" defer></script>

  <!-- ============== SEUS SCRIPTS (ORDEM IMPORTA) ============== -->
  <!-- common.js primeiro: cria socket, sessionId, handlers globais -->
  <script src="/js/common.js" defer></script>
  <!-- host.js depois: usa o que o common expõe -->
  <script src="/js/host.js" defer></script>

  <!-- (Opcional) Função de navegação usada pelo common.js ao encerrar sala -->
  <script defer>
    window.goToHome = () => { window.location.href = "/"; };
  </script>
</head>

<body class="bg">
  <main class="container host">

    <!-- ============== CARD: CONFIGURAR SALA (PRÉ-LOBBY) ============== -->
    <section class="card">
      <h2>Configurar Sala</h2>

      <label>
        Seu nome (opcional)
        <input id="hostNick" placeholder="Professor/Monitor." />
      </label>

      <label>
        Escolha o jogo
        <select id="gameType">
          <option value="monitoria1">Monitoria 1 – Processo de Enfermagem</option>
          <option value="monitoria2">Monitoria 2 – Quiz Biosegurança e Gastro-Endócrino</option>
          <option value="monitoria3">Monitoria 3 – Quiz em Desenvolvimento</option>
        </select>
      </label>

      <button id="btnCreate" class="btn primary">Criar sala</button>
    </section>

    <!-- ============== CARD: LOBBY DA SALA (CÓDIGO, QR E LISTA) ============== -->
    <section id="roomSection" class="card hidden">
      <h2>Sala <span id="roomCode"></span></h2>

      <div class="qr-wrap">
        <!-- QR gerado em host.js (QRCode.toCanvas) -->
        <canvas id="qrCanvas"></canvas>
        <div class="small">Use o QR para entrar</div>
        <div class="small">
          <button id="copyLink" class="btn">Copiar link</button>
        </div>
      </div>

      <div class="players">
        <h3>Jogadores (<span id="pcount">0</span>)</h3>
        <ul id="plist"></ul>
      </div>

      <div class="actions">
        <button id="btnStart" class="btn success" disabled>Iniciar jogo</button>
      </div>
    </section>

    <!-- ============== CARD: PALCO DE PERGUNTAS (DURANTE O JOGO) ============== -->
    <section id="stage" class="card hidden">
      <div class="row between">
        <div><strong>Questão <span id="qIdx">0</span>/<span id="qTot">0</span></strong></div>
        <div>Tempo: <span id="timer">--</span></div>
      </div>

      <div id="qArea" class="qarea"><!-- perguntas renderizadas pelo host.js --></div>

      <div class="actions">
        <button id="btnReveal" class="btn warn">Revelar resposta</button>
        <button id="btnNext" class="btn" disabled>Próxima</button>
      </div>
    </section>

    <!-- ============== CARD: RANKING PARCIAL (FIXO NA PÁGINA) ============== -->
    <section id="rankCard" class="card hidden">
      <h3>Ranking (parcial)</h3>
      <ol id="rankList" class="rank-list"></ol>
    </section>

    <!-- ============== OVERLAY: RANKING PARCIAL (FULLSCREEN) ============== -->
    <section id="rankOverlay" class="overlay">
      <div class="modal">
        <h3>Ranking (parcial)</h3>
        <ol id="rankListOverlay" class="rank-list"></ol>
        <div class="actions" style="margin-top:12px;">
          <button id="btnContinue" class="btn primary">Continuar</button>
        </div>
      </div>
    </section>

    <!-- ============== OVERLAY: RANKING FINAL E PÓDIO ============== -->
    <section id="finalOverlay" class="overlay">
      <div class="modal">
        <h3>Ranking final</h3>

        <!-- Pódio (2º, 1º, 3º) -->
        <div id="finalPodium" class="podium"></div>

        <!-- Lista completa -->
        <ol id="finalList" class="rank-list" style="margin-top:12px;"></ol>

        <div class="actions" style="margin-top:12px;">
          <button id="btnCloseFinal" class="btn primary">Fechar</button>
        </div>
      </div>
    </section>

  </main>
</body>
</html>
